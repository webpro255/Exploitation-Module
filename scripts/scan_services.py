import os

def scan_services(target_ip):
    """
    This function runs an Nmap scan on the target IP to detect open ports,
    running services, and their version information.
    """
    print(f"Scanning target: {target_ip}")
    
    # Run Nmap scan to detect services and versions
    nmap_command = f"nmap -sV {target_ip} -oN scan_results.txt"
    os.system(nmap_command)
    
    # Parse the Nmap results from the output file
    services = []
    with open("scan_results.txt", "r") as file:
        for line in file:
            if "/tcp" in line and "open" in line:
                parts = line.split()
                service_name = parts[2]
                service_version = " ".join(parts[3:])
                services.append({"name": service_name, "version": service_version})
    
    # Display the results
    if services:
        print("\nDetected Services:")
        for service in services:
            print(f"- {service['name']} {service['version']}")
    else:
        print("No services detected or scan incomplete.")

if __name__ == "__main__":
    # Example usage: scan for services on a target IP
    target_ip = input("Enter the target IP address to scan: ")
    scan_services(target_ip)
